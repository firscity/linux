# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/net/can/renesas,rcar-canxl.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Renesas R-Car CAN XL Controller

maintainers:
  - Duy Nguyen <duy.nguyen.rh@renesas.com>

allOf:
  - $ref: can-controller.yaml#

properties:
  compatible:
    oneOf:
      - items:
          - enum:
              - renesas,r8a78000-canxl     # X5H
          - const: renesas,rcar-gen5-canxl # R-Car Gen5

  reg:
    maxItems: 1

  interrupts: true

  clocks:
    maxItems: 3

  clock-names:
    items:
      - const: fck
      - const: canxl
      - const: can_clk

  power-domains:
    maxItems: 1

  resets: true

  renesas,can-fd-frame:
    description:
      The controller can operate in either CAN XL mode (default) or
      CAN FD mode. Specify this property to put the controller in CAN FD mode.

  assigned-clocks:
    description:
      Reference to the CANXL clock.  The CANXL clock can be used by both CAN XL
      and CAN FD controllers at the same time.
      It needs to be scaled to maximum frequency if any of these controllers
      use it.

  assigned-clock-rates:
    description: Maximum frequency of the CANXL clock.

required:
  - compatible
  - reg
  - interrupts
  - interrupt-names
  - clocks
  - clock-names
  - power-domains
  - resets
  - assigned-clocks
  - assigned-clock-rates

properties:
  interrupts:
    items:
      - description: Function interrupt
      - description: Error interrupt

  interrupt-names:
    items:
      - const: func
      - const: err

  resets:
    maxItems: 1

unevaluatedProperties: false

examples:
  - |
    #include <dt-bindings/clock/r8a78000-cpg-mssr.h>
    #include <dt-bindings/interrupt-controller/arm-gic.h>
    #include <dt-bindings/power/r8a78000-sysc.h>

    canxl0: can@c1200000 {
             compatible = "renesas,r8a78000-canxl",
                          "renesas,rcar-gen5-canxl";
             reg = <0 0xc1200000 0 0x20104>;
             interrupts = <0 736 4>,
                          <0 737 4>;
             clocks = <&dummy_clk>,
                      <&canxl_clk>,
                      <&can_clk>;
             clock-names = "fck", "canxl", "can_clk";
             assigned-clocks = <&canxl_clk>;
             assigned-clock-rates = <160000000>;
             power-domains = <&sysc 64>;
             resets = <&cpg 328>;
             channel0;
             status = "okay";
    };
